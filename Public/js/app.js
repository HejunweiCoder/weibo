function initApp(){$("#register").click(function(){$("#login-modal").modal("hide")}),initLogin(),initRegister()}function initLogin(){initForm(null,$("#login-form"),$("#login-modal"),"登录成功","登录失败")}function initRegister(){$registerRules={username:{remote:{url:"/checkUsername",type:"POST",beforeSend:function(){$("#username-status").addClass("fa fa-refresh")},complete:function(jqXHR){1==jqXHR.responseText?$("#username-status").addClass("fa-check").removeClass("fa-refresh"):$("#username-status").removeClass("fa-refresh fa-check")}}},email:{remote:{url:"/checkEmail",type:"POST",beforeSend:function(){$("#email-status").addClass("fa fa-refresh")},complete:function(jqXHR){1==jqXHR.responseText?$("#email-status").removeClass("fa-refresh").addClass("fa-check"):$("#email-status").removeClass("fa-refresh fa-check")}}}},initForm($registerRules,$("#register-form"),$("#register-modal"),"注册成功","注册失败")}function initSiteNavLeft(){var $navWrap=$(".list-group");$navWrap.on("click",null,function(){$navWrap.find("a").attr("class").indexOf("list-group-item-header")!=-1&&($navWrap.find("a").removeClass("active"),$(this).addClass("active"))}),$navWrap.find("a").each(function(){location.pathname+"/"==$(this).attr("href")+"/"&&($navWrap.find("a").removeClass("active"),$(this).addClass("active"))});var $member=$(".member");$member.attr("class").indexOf("active")!=-1&&$member.parent().addClass("in");var $weibo=$(".weibo");$weibo.attr("class").indexOf("active")!=-1&&$weibo.parent().addClass("in")}function initForm($rules,$form,$modal,success,fail){var options={rules:$rules,ignore:".ignore",highlight:function(el){$(el).closest(".form-group").addClass("has-error"),$(el).closest(".form-group").find(".help-block").addClass("hidden")},unhighlight:function(el){$(el).closest(".form-group").removeClass("has-error"),$(el).closest(".form-group").find(".help-block").addClass("hidden")},errorPlacement:function(error,element){element.parent(".input-group").length?error.insertAfter(element.parent()):error.insertAfter(element)},submitHandler:function(form){$.ajax({url:$(form).prop("action"),type:"POST",data:$(form).serializeArray()}).done(function(data){"success"==data?(swal(success,"","success"),$modal.modal("hide"),location.reload()):swal(fail,data,"error")})}};$form.validate(options)}